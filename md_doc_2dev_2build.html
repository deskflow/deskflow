<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Deskflow: Building Deskflow</title>
<link rel="icon" href="deskflow-logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="deskflow-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Deskflow<span id="projectnumber">&#160;1.24.0.188</span>
   </div>
   <div id="projectbrief">Keyboard and mouse sharing utility</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_doc_2dev_2build.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Building Deskflow </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<p>To build Deskflow you will a minimum of:</p><ul>
<li><a href="https://cmake.org/">cmake</a> 3.24+</li>
<li><a href="https://www.qt.io">Qt</a> 6.7.0+</li>
<li><a href="https://www.openssl.org/">openssl</a> 3.0+</li>
<li><a href="https://github.com/flatpak/libportal">libportal</a> 0.8+ (linux, bsd)</li>
<li><a href="https://gitlab.freedesktop.org/libinput/libei">libei</a> 1.3+ (linux, bsd)</li>
<li><a href="https://github.com/google/googletest">google_test</a> ^</li>
</ul>
<blockquote class="doxtable">
<p>^ Will be fetched if not found on the host system. </p>
</blockquote>
<p>By default a build of Deskflow will:</p><ul>
<li>The GUI application deskflow</li>
<li>The Core application deskflow-core</li>
<li>Documentation if <a href="http://www.stack.nl/~dimitri/doxygen/">doxygen</a> was found on your system</li>
<li>Tests that will be run as part of the build process.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
Configuration</h1>
<p>Deskflow supports the following build options</p>
<p>CMake options: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Option  </th><th class="markdownTableHeadCenter">Description  </th><th class="markdownTableHeadCenter">Default Value  </th><th class="markdownTableHeadCenter">Additional requirements  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">BUILD_GUI  </td><td class="markdownTableBodyCenter">Build GUI  </td><td class="markdownTableBodyCenter">ON  </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">BUILD_USER_DOCS  </td><td class="markdownTableBodyCenter">Build user documentation  </td><td class="markdownTableBodyCenter">DOXYGEN_FOUND  </td><td class="markdownTableBodyCenter"><span class="tt">Doxygen</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">BUILD_DEV_DOCS  </td><td class="markdownTableBodyCenter">Build development documentation  </td><td class="markdownTableBodyCenter">OFF  </td><td class="markdownTableBodyCenter"><span class="tt">Doxygen</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">BUILD_INSTALLER  </td><td class="markdownTableBodyCenter">Build installers/packages  </td><td class="markdownTableBodyCenter">ON  </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">BUILD_TESTS  </td><td class="markdownTableBodyCenter">Build unit tests and legacy tests  </td><td class="markdownTableBodyCenter">ON  </td><td class="markdownTableBodyCenter"><span class="tt">gtest</span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">ENABLE_COVERAGE  </td><td class="markdownTableBodyCenter">Enable test coverage  </td><td class="markdownTableBodyCenter">OFF  </td><td class="markdownTableBodyCenter"><span class="tt">gcov</span>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">SKIP_BUILD_TESTS  </td><td class="markdownTableBodyCenter">Skip running of tests at build time  </td><td class="markdownTableBodyCenter">OFF  </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">VCPKG_QT  </td><td class="markdownTableBodyCenter">Build Qt w/ vcpkg (windows only)  </td><td class="markdownTableBodyCenter">OFF  </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CLEAN_TRS  </td><td class="markdownTableBodyCenter">Remove obsolete strings from tr files  </td><td class="markdownTableBodyCenter">OFF  </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">APPLE_CODESIGN_DEV  </td><td class="markdownTableBodyCenter">Apple codesign cert ID for development  </td><td class="markdownTableBodyCenter">Not set  </td><td class="markdownTableBodyCenter"></td></tr>
</table>
<p>Example cmake configuration. <span class="tt">cmake -S. -Bbuild -DCMAKE_INSTALL_PREFIX=&lt;INSTALLPREFIX&gt;</span></p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Windows Configuration</h2>
<p>It is recommended to use vcpkg to install the dependencies. The first time you configure Deskflow, all dependencies other than Qt will be built. If you don't want to use vcpkg, you must manually setup the dependencies. However, that will not be covered by this document.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
Windows and Qt</h3>
<p>There are two ways you can install <a href="https://www.qt.io">Qt</a> on Windows (vcpkg or Qt online installer). The default configuration expects you to use the Qt online installer. You should not install Qt in both ways, as having both can cause some weird things to happen, like Qt getting libs from one install and plugins from the other. When switching between them, remove the previous install first.</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
System Qt</h4>
<ol type="1">
<li>Download and install the <a href="https://www.qt.io">Qt</a> online installer from their website.</li>
<li>Add the path of Qt's cmake files to your system path. (Skipping this may require you provide this path to cmake via <span class="tt">Qt6_DIR</span> at configure time)<ul>
<li>Often <span class="tt">C:\Qt\&lt;version&gt;\&lt;msvcinfo&gt;\lib\cmake</span></li>
</ul>
</li>
<li>Add the path of Qt's binary tools to your system path.<ul>
<li>Often <span class="tt">C:\Qt\&lt;version&gt;\&lt;msvcinfo&gt;\bin</span></li>
</ul>
</li>
</ol>
<h4 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Vcpkg managed Qt</h4>
<ol type="1">
<li>Add the option <span class="tt">-DVCPKG_QT=ON</span> to your cmake configuration command (i.e <span class="tt">cmake -S. -Bbuild -DVCPKG_QT=ON ...</span>) or if using an IDE, look for the option where you configure the project, have the IDE run cmake again.</li>
<li>Once the configuration starts, you should see a lot more packages vcpkg will build. Building Qt takes a long time (potentially hours), so go find something else to do for a while.</li>
<li>If you want to use the system Qt again, you must delete the <span class="tt">vcpkg.json</span> generated in the project root and the <span class="tt">build</span> folder and reconfigure the project from scratch.</li>
</ol>
<h2 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
macOS codesign</h2>
<p>The code signing option <span class="tt">APPLE_CODESIGN_DEV</span> is only for local development and not intended for distributed bundles.</p>
<p>Signing for local development and signing for the distribution bundle must be different because of development entitlements which are unlikely to be safe for use in production. It is impractical (i.e. very slow and cumbersome) to use the distribution bundle for local development. When developing locally, the app bundle is partial and does not contain dependencies and uses external libs, e.g. installed with Homebrew; the entitlements allow those external libs to be loaded which is not allowed by default.</p>
<p>For development codesign:</p>
<ol type="1">
<li>Install Xcode</li>
<li>Go to <a class="el" href="classSettings.html">Settings</a> -&gt; Accounts</li>
<li>Add your account (requires a free Apple Developer ID)</li>
<li>Manage certificates -&gt; Add -&gt; Apple Development</li>
<li>To get your ID, run: <span class="tt">security find-identity -v -p codesigning login.keychain-db</span></li>
<li>Pass the ID to CMake, e.g. <span class="tt">-DAPPLE_CODESIGN_DEV=Apple Development: bob@exmaple.com (KLGSJHLFXY)</span></li>
<li>Configure and build</li>
<li>To verify, run: <span class="tt">codesign -d -r- build/bin/Deskflow.app</span></li>
</ol>
<h1 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
Build</h1>
<p>After configuring you should be able to run make to build all targets.</p>
<p><span class="tt">cmake --build build</span></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Install</h1>
<p>To test installation run <span class="tt">DESTDIR=&lt;installDIR&gt; cmake --install build</span> to install into <span class="tt">&lt;installDir&gt;/&lt;CMAKE_INSTALL_PREFIX&gt;</span> <br  />
 Running <span class="tt">cmake --install build</span> will install to the <span class="tt">CMAKE_INSTALL_PREFIX</span></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md9"></a>
Making Deskflow packages</h1>
<p>Deskflow can generate several packages using cpack. To generate packages build the <span class="tt">package</span> or <span class="tt">package_source</span> target. Example: <span class="tt"> cmake --build build --target package package_source</span> would generate both package and package source packages. Deskflow can generate several package types depending on the system. Archive-based packages should work on all platforms. On Linux deb and rpm info is set up, flatpaks can be generated from the included file in deploy/linux and a PKGBUILD for <a class="el" href="classArch.html" title="Delegating implementation of architecture dependent interfaces.">Arch</a> linux is generated in the build folder. On macos a dmg file will be created and signed. For windows wix can be used to create an installer. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
